{% extends 'workflows/modals/modal-base.html' %}
{% load i18n %}
{% load crispy_forms_tags %}
  {% comment %}
    {% load ou_options %}
  {% endcomment %}
{% block content %}
{% if object %}
<h3>{% trans "Add an action" %}</h3>
{% else %}
<h3>{% trans "Update action " %} {{Â object }}</h3>
{% endif %}

<form method="POST" action="{{request.path}}">

  {% csrf_token %}
  {% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
  {% endif %}

  <div class="mb-3" id="div_id_title">
    <label class="form-label" for="id_title">
      {% trans 'Title' %}
    </label>
    <input class="textinput form-control" id="id_title" maxlength="255" name="title" type="text" value="{{ form.title.value }}">
  </div>

  <div class="mb-3" id="div_id_description">
    <label class="form-label" for="id_description">
      {% trans 'Description' %}
    </label>
    <textarea class="textarea form-control" cols="40" id="id_description" name="description" rows="4">
    {{ form.description.value }}
    </textarea>
  </div>

  <h5>Profile</h5>
  <div id="div_id_use_existing_profile" class="mb-3">
    <div>
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_profile" checked="checked" value="none" id="id_use_existing_profile_0" required="">
        <label for="id_use_existing_profile_0" class="form-check-label mb-2">
            {% trans 'No profile (only the organization)' %}
        </label>
      </div>
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_profile" value="use" id="id_use_existing_profile_1" required="">
        <label for="id_use_existing_profile_1" class="form-check-label mb-2">
            {% trans 'Select an existing profile' %}
        </label>
        {{ form.profile|as_crispy_field }}
      </div>
      <div class="mb-5"></div>
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_profile" value="create" id="id_use_existing_profile_2" required="">
        <label for="id_use_existing_profile_2" class="form-check-label">
            {% trans 'Create a new profile' %}
        </label>
        {{ form.new_profile_name|as_crispy_field }}
      </div>
    </div>
  </div>

  <h5>Organization unit</h5>
  <div id="div_id_use_existing_organization_unit" class="mb-3">
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_organization_unit" checked="checked" value="none" id="id_use_existing_organization_unit_0" required="">
        <label for="id_use_existing_organization_unit_0" class="form-check-label mb-2">
            {% trans 'No organization unit (only the profile)' %}
        </label>
      </div>
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_organization_unit" checked="checked" value="use" id="id_use_existing_organization_unit_1" required="">
        <label for="id_use_existing_organization_unit_1" class="form-check-label mb-2">
            {% trans 'Select an existing organization unit' %}
        </label>
        {{ form.organization_unit|as_crispy_field }}
      </div>
      <div class="mb-5"></div>
      <div class="form-check">
        <input type="radio" class="form-check-input" name="use_existing_organization_unit" value="create" id="id_use_existing_organization_unit_2" required="">
        <label for="id_use_existing_organization_unit_2" class="form-check-label">
            {% trans 'Create a new organization unit' %}
        </label>
        {{ form.new_organization_unit_name|as_crispy_field }}
        {{ form.new_organization_unit_parent|as_crispy_field }}
      </div>
  </div>

  <button class="btn btn-outline-primary" type="submit">{% trans 'Add action' %}</button>
</form>
<script type="text/javascript">
$(document).on("focus", "#id_profile", function (e) {
    $('#id_use_existing_profile_1').prop('checked',true);
});
$(document).on("focus", "#id_new_profile_name", function (e) {
    $('#id_use_existing_profile_2').prop('checked',true);
});
$(document).on("focus", "#id_organization_unit", function (e) {
    $('#id_use_existing_organization_unit_0').prop('checked',true);
});
$(document).on("focus", "#id_new_organization_unit_name", function (e) {
    $('#id_use_existing_organization_unit_1').prop('checked',true);
});
$(document).on("focus", "#id_new_organization_unit_parent", function (e) {
    $('#id_use_existing_organization_unit_1').prop('checked',true);
});
</script>
{% endblock %}
